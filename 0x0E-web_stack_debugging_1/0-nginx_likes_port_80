#!/usr/bin/env bash
# This script configures Nginx to listen on port 80

# Install Nginx (if not already installed)
apt-get update
apt-get install -y nginx

# Check if Nginx is running
nginx_status=$(ps aux | grep nginx | grep -v grep)
if [[ -z "$nginx_status" ]]; then
    echo "Nginx is not running. Starting Nginx..."
    service nginx start
else
    echo "Nginx is already running."
fi

# Configure Nginx to listen on port 80
sed -i 's/listen 80 default_server;/listen 80;/g' /etc/nginx/sites-available/default

# Reload Nginx to apply the changes
service nginx reload

# Verify if Nginx is listening on port 80
nginx_listen=$(netstat -tuln | grep ':80')
if [[ -z "$nginx_listen" ]]; then
    echo "Nginx is not listening on port 80."
else
    echo "Nginx is listening on port 80."
fi
